{% extends "base.html" %}
{% load static %}
{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/backoffice.css' %}">
{% endblock %}

{% block title %}Messages envoyés — Tableau de bord{% endblock %}

{% block content %}
<div class="bo-shell">
  <aside class="bo-sidebar" aria-label="Navigation messages">
    <div class="bo-brand">Nettoyage Express</div>
    <nav class="bo-nav">
      <a href="{% url 'core:dashboard' %}">Retour dashboard</a>
      <a href="{% url 'messaging:compose' %}">Nouveau message</a>
      <a class="is-primary" href="{% url 'messaging:list' %}">Historique</a>
    </nav>
  </aside>

  <main class="bo-main">
    <div class="bo-head">
      <div>
        <div class="bo-title">Messages envoyés</div>
        <div class="bo-subtitle">Historique des e-mails (HTML uniquement).</div>
      </div>
    </div>
  {% if email_messages %}
  <table class="bo-table">
    <thead>
      <tr>
        <th>Sujet</th>
        <th>Destinataire(s)</th>
        <th>Statut</th>
        <th>Envoyé le</th>
      </tr>
    </thead>
    <tbody>
      {% for m in email_messages %}
      <tr>
        <td><a href="{% url 'messaging:detail' m.pk %}">{{ m.subject }}</a></td>
        <td>{{ m.recipient }}</td>
        <td>{{ m.get_status_display }}</td>
        <td>
          {% if m.sent_at %}
            {{ m.sent_at|date:'d/m/Y H:i' }}
          {% else %}
            —
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <p>Aucun message n'a encore été envoyé.</p>
  {% endif %}
  </main>
</div>
{% endblock %}